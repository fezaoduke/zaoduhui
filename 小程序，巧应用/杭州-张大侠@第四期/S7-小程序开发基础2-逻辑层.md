
逻辑层，处理事务逻辑。在微信小程序里就是所有.js脚本文件的集合。微信小程序**在逻辑层将数据进行处理后发送给视图层，同时接受视图层的事件反馈**。

微信小程序逻辑层由js编写，与传统js不同的是：
- 增加了App和Page方法，进行程序和页面的注册
- 提供丰富的API，如扫一扫、支付等微信特有能力
- 每个页面由独立的作用域，并提供模块化能力
- 由于js并非运行在浏览器中，所以与浏览器相关的js API都无法使用，例如DOM操作、window全局变量等。

在开发过程中，逻辑层的实现即为编写各个页面的.js脚本，最终将会打包成一份js文件，并在小程序启动的时候运行，直到小程序销毁。类似_Service Worker_。因此逻辑层也成为App Service。

## 注册程序~App()方法

作用：注册一个小程序，整个小程序有且仅有一个App()方法，存在app.js中。

参数：object，主要用于指定小程序的生命周期等

参数说明：

- onLaunch：Function/生命周期函数——监听小程序**初始化**/当小程序初始化完成时，会触发onLaunch函数（并且**全局只会触发一次**）
- onShow：Function/生命周期函数——监听小程序**显示**/当小程序显示时（启动，或从后台进入前台），会触发onShow函数
- onHide：Function/生命周期函数——监听小程序**隐藏**/当小程序从前台进入后台，会触发onHide函数
- 其他：Any/开发者可以添加任意的函数或数据到Object参数中，用this可以访问

Q：小程序前台，后台？
A：用户当前**界面运行**或**操作小程序**时为前台；当用户**点击左上角关闭**，或者**按了设备HOME键离开微信**，小程序则进入了后台，注意此时小程序**并没有直接销毁**！当再次进入微信（直接进入小程序界面）或再次打开小程序，又会从后台进入前台。

Q：小程序什么时候会被销毁？
A：只有当小程序**进入后台一定时间**，或者**系统资源占用过高**，才会被真正销毁。此时代表小程序的生命周期结束。

另外，微信小程序在App()函数外（函数内用this便可获取）提供了全局获取的getApp()函数，可以用来获取小程序实例。注意获取实例后，不可私自调用生命周期函数！

## 注册页面~Page()方法

作用：注册一个页面，在每个页面有且仅有一个Page()方法，存在该页面的.js文件中

参数：object，用于指定页面的初始数据、生命周期函数、事件处理函数等。

参数说明：

- data：Object/页面的初始数据
- onLoad：Function/生命周期函数-监听页面加载
- onReady：Function/生命周期函数-监听页面初次渲染完成
- onShow：Function/生命周期函数-监听页面显示
- onHide：Function/生命周期函数-监听页面隐藏
- onUnload：Function/生命周期函数-监听页面卸载
- onPullDownRefreash：Function/页面相关事件处理函数——监听用户下拉动作
- onReachBottom：Function/页面上拉触底事件的处理函数
- 其他：Any/开发者可以添加任意的函数或数据到object参数中，用this可以访问

另外，微信小程序提供了getCurrentPage()函数，用来获取当前页面的实例。需要注意的是**在App()中进行onLaunch操作的时候不要调用此函数**，因为当前page还未生成。（笔者注：在函数里面不可以用this获取到吗？而且此方法应该是只有在本函数内使用吗？）

--more--





